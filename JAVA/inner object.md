# JSP 기본 문법
-----------------
# 1. 주석
HTML 주석 : 클라이언트로 전달되는 주석
<!-- 주석-->
JSP 주석 : 클라이언트로 전달되지 않는 주석
<%-- 주석 --%>
/* */ , //, /** */ : JSP 에서 스크립트릿(자바 코드가 위치하는 곳)에는 일반적인 자바 주석 사용 가능

# 2. 지시어
지시어 : 해당하는 JSP 파일의 속성을 기술하는 곳
JSP 컨테이너에게 해당 페이지를 어떻게 처리해야 하는지 전달하기 위한 내용을 담음
page, include, taglib 로 나뉘며 속성이 다름.
사용 유형은 대부분 고정되어 있는 경우가 많으며, 이클립스에서는 많은 부분이 미리 만들어져 있는 템플릿에 의해 자동으로 작성됨.

## 2.1 page 지시어
page 지시어 : 현재의 jsp 페이지를 컨테이너에서 처리하는 데 필요한 각종 속성을 기술하는 부분
<%@ page 속성1="속성값1" 속성2="속성값2" ...%>
여러줄에 나누어 작성 가능
-language (language="java")
-import : jsp 내에서 사용할 외부 자바 패키지나 클래스를 가져옴
-session : 웹 브라우저와 웹 서버가 지속적으로 클라이언트를 인식하려고 필요한 정보를 임시로 저장해두는 방법.기본값은 true
-buffer : 데이터를 더욱 효율적이고 안전하게 전송하기 위해 전송할 데이터를 확보한 후 전송할 때 사용할 버퍼 크기 지정
-autoFlush : 버퍼 속성의 버퍼가 다 차면 자동으로 전송해 버퍼를 비움 기본값은 true
-isThreadSafe : 각 스레드가 프로그램의 자원(멤버변수 등)을 공유할 때 데이터의 안정성을 보장해줌.
-info : 일종의 주석문
-errorPage : 현재 JSP 페이지에서 오류가 발생할 경우 호출할 페이지. 일관된 JSP 오류 처리와 오류 처리 수준 설정 가능 
-isErrorPage : errorPage 속성에 설정된 오류 처리 파일
-contentType : 현재 JSP 페이지를 클라이언트에서 처리하기 위한 콘텐츠 유형 지정
MIME ( Multi Purpose Intent Mail Extensive) type 지정
-pageEncoding : 컨테이너에서 처리할 JSP 파일의 인코딩 설정
-extends : 해당 JSP 페이지를 특정 클래스를 상속한 클래스로 지정

## 2.2 include 지시어
include 지시어 : 현재 JSP 파일에 다른 HTML 이나 JSP 문서를 포함하기 위한 기능 제공
각각의 파일을 포함한 뒤 하나의 컴파일된 클래스를 생성하므로 include문만을 목적으로 사용할 파일은 page 지시어 이외의 HTML 기본 태그 생략 가능.
## 2.3 taglib 지시어
JSP 기능을 확장하기 위해 만들어진 커스텀 태그 라이브러리를 JSP 파일에서 사용하기 위한 지시어
-uri : 커스텀 태그 구조를 정의한 XML 형식의 파일인 TLD(Tag Library Descriptor) 파일을 지정하는데 사용
-prefix : 현재 JSP 파일에서 커스텀 태그를 사용하기 위한 이름으로 일종의 접두어 역할을 함.

URI : Uniform Resource Identifier 필요로 하는 자원의 위치 정보를 기술하는데 사용
URL과달리 프로토콜, 주소, 포트번호를 제외한 경로만 표시

## 3. 액션
액션 : JSP 페이지 간의 흐름을 제어하고 자바 애플릿을 지원하며 자바 빈즈 컴포넌트와 JSP 상호작용을 지원하는 기능
<jsp : action_name attribute = "value" />
## 3.1 JSP 액션의 종류
-include : include 지시어가 해당 파일을 포함시킨 후 컴파일하는 것에 비해, 실행 시점에서 해당 파일을 호출하여 그 결과를 포함함.
포함될 파일들을 각각 핸들링하므로 성능상의 문제 야기 가능. 따라서 동적인 페이지를 포함시킬 경우 사용하고 include 지시어는 정적인 페이지를 포함시킬 대 사용하는 것이 좋음.
다른 파일로 포워딩할 때 param 태그를 이용해 속성 값 전달 가능.
(
test.jsp
<jsp : include page = "footer.jsp">
<jsp : param name = "usage" value = "test"/>
</jsp : include>
footer.jsp 
< %= request.getParameter("usage")%>)
-forward : include 액션과 유사하지만 현재 페이지를 완전히 다른 페이지로 전환할 때 사용
response 내장 객체의 SendRedirect() 메서드와 비슷한 기능 수행
param 태그를 이용해 속성 값 전달 가능.
-useBean 
-setProperty
-getProperty
-plugin : 웹 브라우저에서 자바 플러그인을 사용하여 자바 애플릿이나 자바 빈즈 컴포넌트 실행 가능
웹 브라우저 대부분이 자바를 플러그인 형태로 지원하므로 브라우저에 내장된 자바 가상머신으로는 스윙 애플릿 등을 실행할 수 없는 점을 보완하려고 나온 개념
자바로 작성한 애플릿은 <Applet> 태그로 실행할 수 없고 인터넷 익스플로러에서는 <OBJECT> 태그로 자바 플러그인 사용 가능.
plugin 액션은 웹 브라우저에 따라 자동으로 해당 태그를 생성하므로, 웹 브라우저에 독립적인 개발 가능.
-param : include, forward 액션에서 사용 가능한 파라미터 설정

## 4. 선언과 표현식
JSP에서 메서드나 멤버변수를 선언할 수 있으므로 프로그램 요소를 구현하기 쉬워지ㅣ만 일반적으로 JSP에서 자바 코드를 확장하는 것보다는 별도의 빈즈 클래스나 자바 클래스를 사용하는 것이 좋음

### 4.1 선언
선언 : JSP 내에서 메서드나 멤버 변수 선언
<%! %>
### 4.2 표현식
표현식 : 데이터 출력이나 메서드 호출
세미콜론을 사용하지 않음.
<%= %>

## 5. 스크립트릿
스크립트릿 : JSP 문서 내에 자바 코드를 기술하는 부분으로 순수 자바 코드만 사용 가능.
본문 어디서나 사용할 수 있지만 권장하지 않음.
JSP에서 스크립트릿 사용을 지양하기 위해 EL (Expression Language),JSTL, 커스텀 태그 라이브러리, JSP 빈즈 사용을 권장함.

## 6. JSP 내장객체
JSP 내장객체 : JSP 내에서 선언하지 않고 사용하는 객체
JSP가 서블릿 형태로 자동 변환된 코드 내에 포함되어 있는 멤버 변수, 메서드 매개 변수 등 각종 참조 변수
보통 스크립트릿에서 사용하며, 내장객체를 통하면 사용자 요청을 컨트롤하여 페이지 간의 데이터 공유 가능.
-request
-response
-session
-out
-application

### 6.1 JSP 내장객체의 구조적 특징
작성된 JSP 코드는 모두 _jspService()메서드 안으로 들어가기 때문에
매개변수인 request, response와 지역변수로 선언된 pageContext, session, application, page, config, out 등은 모두 내장객체가 됨.
즉 JSP 내장객체는 서블릿 형태로 변환된 코드의 _jspService() 메서드 내에서 참조할 수 있는 객체임.
따라서 해당 JSP 파일에서 프로그램을 작성할 때는 내장객체를 별도의 선언 없이 사용가능.

### 6.2 request
request : 사용자 요청과 관련된 기능을 제공하는 내장객체로 클라이언트에서 서버로 전달되는 정보를 처리하기 위해 사용함.
가장 대표적인 유형이 HTML 폼을 통해 입력된 값을 JSP에서 가져올 때 사용하는 것. 

쿠키 : 클라이언트와 서버 간의 연결이 유지되지 않는 웹 프로그램의 문제점을 보완하려고 클라이언트에 간단한 데이터를 저장하고 있다가 서버에서 요청이 오면 브라우저가 이를 제공하는 기술
### 6.3 response
response : 사용자 응답과 관련된 기능을 제공하는 내장객체로 사용자 요청을 처리하고 응답을 다른 페이지로 전달하는 등의 기능을 제공함.
sendRedirect() 메서드는 현재 페이지를 다른 페이지로 전달함. forward 액션과 유사하지만, 단순히 사용자 요청을 다른 페이지로 보내는 것으로 새로운 페이지를 위한 request 및 sendRedirect 객체가 생성됨.
forward의 경우 원래 요청에 포함된 request 및 response 객체가 그대로 전달됨.

*no cache
209
### 6.4 out
out : 출력 스트림으로써, 사용자 웹 브라우저로 출력하기 위한 채널.
서버의 콘솔이 아닌 사용자에게 전달됨.
페이지에 대한 정밀한 튜닝이 필요한 경우 버퍼 관련 메서드 사용 가능.
*211

### 6.5 session
HTTP는 비연결형 프로토콜이므로 한 페이지 출력 후에는 클라이언트와 서버의 연결이귾어짐. 따라서 한번 로그인한 사용자가 로그아웃할 때까지 보관해야 할 정보가 있다면 처리 곤란.
이 문제를 해결하기 위해 쿠기와 세션 등장
쿠키 : 사용자와 관련된 정보를 PC에 보관하는 방식
세션 : 사용자와 관련된 정보를 서버에 보관하는 방식
쿠키보다 보안 문제에 유리하고 제약사항이 적은 편이라 세션이 범용적

JSP에서 세션은 session 내장 객체를 통해 접근 가능
세션은 연결된 사용자마다 생성되는 것으로 서버에 연결된 각각의 사용자마다 자신만의 세션 영역이 존재

## 7. 그 밖의 내장객체
### 7.1 config
서블릿이 최초로 메모리에 적재될 때 컨테이너는 서블릿 초기화와 관련된 정보를 읽고 javax.servlet.ServletConfig 객체에 저장함.
ServletConfig 클래스에 대한 참조 변수

초기화값은 웹 애플리케이션을 배치할 때 컨테이너와 호환되는 배치 도구 등을 이용하여 설정 가능.

### 7.2 application
웹 애플리케이션(컨텍스트) 전체를 관리하는 객체
각 서블릿이나 JSP에서 공유하려고 하는 각종 정보를 설정하고 참조 가능
javax.servlet.ServletContext 객체에 대한 참조 변수
서블릿이 실해외는 환경이나 서버 자원과 관련한 정보를 얻거나 로그 파일을 기록하는 작업 등을 수행함

application 내장객체의 유효 범위는 해당 컨텍스트가 시작되어 종료되는 범위.
애플리케이션 단위로 시작과 종료를 하는 것이 아니라 톰캣 서비스를 종료하고 시작하는 경우가 많으므로 톰캣의 시작과 종료를 application 내장객체의 유효 범위로 봐도 무방함.

### 7.3 page
JSP 컨테이너에서 생생된 서블릿 인스턴스 객체를 참조하는 참조 변수
JSP에서 자기 자신을 참조할 때 사용됨.

### 7.4 pageContext
javax.servlet.jsp.PageContext 인스턴스에 대한 참조 변수
다른 모든 내장객체에 대한 프로그램적인 접근 방법을 제공하며, HTTP 요청을 처리하는 제어권을 다른 페이지로 넘길 때 사용함.
대부분의 내장객체는 별도의 선언없이 사용할 수 있으므로 pageContext를 통해 내장객체에 접근하는 것은 큰 의미가 없음.

### 7.5 exception
page 지시어에서 오류 페이지로 지정된 JSP 페이지에서 예외가 발생할 때 전달되는 java.lang.Throwable 의 인스턴스에 대한 참조 변수

## 8. JSP 내장객체와 속성 관리
### 8.1 HTTP 프로토콜 특징과 내장객체 속성 관리
JSP는 HTTP 프로토콜을 사용하는 웹 환경에서 구동되는 프로그램.
이러한 웹 프로그램은 비연결 방식으로, 사용자가 서버에 특정 페이지를 요청하고 요청결과를 응답받으면 서버와의 연결이 끊기는 형태.

application은 모든 사용자가 공유하는 데이터를 저장할 수 있으며 톰캣이 종료할 때까지 데이터 유지 가능(톰캣 종료 시 소멸)
session은 사용자마다 분리된 저장 영역이 있으며 일정시간이 경과하거나 브라우저가 종료될 때까지 데이터 유지 가능
request는 한 페이지가 요청된 후 해당 페이지가 로딩 완료될 때가지 데이터 유지 가능

### 8.2 request, session, application을 이용한 속성 관리
request, session, application 내장 객체는 각각의 고유 기능뿐 아니라 맵 형태의 속성을 관리하는 기능을 제공함.
setAttribute(String name, Object value) 메서드와 getAttribute(String name) 메서드를 사용해 이 내장객체들의 속성 관리 가능.
JSP 내장객체의 속성 : 내장객체의 생명주기 내에서 관리될 수 있는 자바의 Object 형태의 데이터
맵 기반으로 속성을 관리하는 기본적인 방법은 '이름(Name):값(Value)'의 쌍으로 객체를 저장하고 나중에 이름으로 데이터를 찾는 방식.
HashMap과 유사함.

### 8.3 컨테이너 기반 프로그램의 특징과 JSP 내장객체
컨테이너 : 프로그램 실행에 관여하면서 모듈화된 프로그램을 실행할 수 있게 하고 프로그램 간의 원활한 데이터(객체) 교환을 지원하는 소프트웨어
웹 프로그램도 컨테이너 기반이며 대표적인 프레임워크인 스프링 역시 컨테이너 기반의 프로그램 모델이 됨.
컨테이너 기반 프로그램의 장점
1. 프로그램의 모듈화 용이
2. 독립적으로 실행되는 모듈 간의 데이터 교환 용이
3. 개별 프로그램에서 화면/상태 전환 시 데이터를 유지/관리하기 용이함.
4. JSP에서는 컨테이너에 의해 관리되는 내장객체를 통해 임의의 객체를 각각의 생명주기 시점에 따라 공유 가능
JSP 에서 내장 객체를 이용한 속성 관리가 가능한 것은 JSP와 빈즈 객체들이 톰캣일고 하는 컨테이너에 의해 관리되고 실행되기 때문임.

### 8.4 MVC 패턴과 JSP 내장 객체
MVC 패턴에 따르면 JSP는 화면에 데이터를 출력하는 뷰의 역할만 수행해야 하는데, JSP는 별도로 데이터를 가지고 오는 로직 없이 데이터를 출력할 수 있어야 함.
이때 JSP 내장 객체를 이용한 속성 관리가 사용됨.
컨트롤러에서 처리한 데이터는 request.setAttribute() 를 이용해 저장하고 화면에 보여질 JSP로 포워딩하면 해당 JSP에서는 requset 내장객체를 통해 데이터를 참조할 수 있으므로 완전한 MVC 패턴 구현 가능. <jsp:useBean>,<jsp:getProperty>혹은 표현식을 사용했으나 표현 언어와 JSTL 을 이용할 경우 더욱 편리하게 구현 가능.


