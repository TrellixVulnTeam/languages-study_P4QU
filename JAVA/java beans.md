# JSP와 자바 빈즈
---------------------
## 1. 빈즈 개요
beans : 특정한 일을 독립적으로 수행하는 컴포넌트
원래 자바에서 GUI 위젯을 제작하려고 만들었으나 J2EE가 발표되면서 각각 엔터프라이즈 자바 빈즈와 JSP에서 사용하는 JSP 빈즈로 나뉘어 개념이 확장됨.
용도는 다르지만 프로그램 모듈화를 위한 컴포넌트임.

## 1.1 자바 빈즈
POJO : Plain Old Java Object 특정 기술이나 프레임워크에 종속적이지 않고 기본 생성자와 멤버변수에 대한 getter/setter 메서드를 제공하고 직렬화할 수 있는 자바 클래스
GUI 프로그램을 만들기 위한 컴포넌트 모델로 사용되었으나 최근에는 EJB나 JSP 빈즈에서 '빈즈'라는 표현을 더 많이 사용하며 GUI 프로그램에서 '빈즈'라는 표현은 쓰지 않음.

## 1.2 JSP 빈즈
JSP와 연동하려고 만들어진 컴포넌트 클래스로 컨테이너에 위치하며, JSP에 데이터베이스 연동 등 프로그램적 요소를 모듈화할 수 있도록 도와줌.
데이터 처리와 공용화된 기능을 제공하므로 프로그램의 중복을 줄이고 더욱 원활하게 유지 보수 가능. 따라서 가능하면 JSP 코드 내에 스크립트릿을 사용하는 것보다 빈즈를 만들어 사용하는 것이 좋음.

일반적인 빈즈 활용의 경우 개별 JSP에서 필요에 따라 빈즈 클래스를 선언하고 불러와서 사용함. 그러나 MVC 패턴에서는 컨트롤러에서 빈즈 클래스를 사용하고 뷰에 필요한 객체들을 만들어 공급하는 형태로 구현됨.

## 1.3 엔터프라이즈 자바 빈즈
EJB : Enterprise Java Beans 애플리케이션에서 비즈니스 로직을 구현하려는 컴포넌트 모델
보안을 중시하고 규모가 크며 확장 및 다른 시스템과의 상호,운용을 필요로 하는 애플리케이션 개발에 필요한 핵심 기술이나 개발의 복잡성, 컨테이너 간 호환성 등 여러 문제로 인해, JPA (Java Persistence API) 를 핵심으로 하는 Java EE가 발표되며 기존 엔티티빈의 상당 부분을 대처하게 됨.
-엔티티빈 : EJB의 컴포넌트 중 하나로 데이터베이스와의 연동을 담당하는 빈즈

# 2. JSP와 빈즈 연동
JSP 빈즈는 JSP에서 사용할 수 있는 자바 컴포넌트로 빈즈 액션과 결합하여 웹 프로그램을 더욱 간편하고 단순한 구조로 처리 가능.

## 2.1 빈즈 연동 개요
빈즈도 자바 클래스이므로 JSP 파일의 스크립트릿 부분에서 인스턴스를 만들어 사용 가능.
일반 클래스와 다른 JSP 빈즈만의 특징적인 요소를 활용하여 더욱 편하게 프로그램 작성 가능.

빈즈와 상호작용
1. 사용자 입력을 받기 위한 HTML 폼 입력값은 각각의 form 요소의 name 속성 값을 통해 a.jsp 로 전달됨.
2. a.jsp는 useBean 액션을 이용해서 빈즈 클래스를 불러오고 setProperty를 통해 폼으로부터 전달받은 값을 빈즈 클래스의 멤버변수의 값으로 전달함.
3. 이때 빈즈 클래스의 setter 메서드들이 자동으로 호출됨.
4. 빈즈 클래스 값을 참조하려면 getter 메서드를 사용함.
5. 결과를 보여주기 위한 b.jsp 에서는 a.jsp 와 마찬가지로 useBean 액션을 이용해 빈즈 클래스를 참조하고 getProperty를 이용해 멤버변수 값을 출력함.

빈즈 구현 형태
-데이터베이스 연동을 포함해서 데이터와 여러 기능을 함께 구현하는 방법(DO, DAO 클래스의 통합 형태)
빈즈 내부에 데이터베이스 접속과 관련한 정보를 포함하여 입력, 출력, 삭제와 같은 모든 데이터베이스 처리 로직을 갖는 형태.
-데이터 매핑과 데이터베이스 접속, 입력, 출력, 삭제와 트랜잭션 처리를 분리해서 구현하는 방법(DO,DAO 클래스의 분리 형태)
Data Object와 DAO(Data Access Objecct)를 분리한 형태로, DO 클래스에는 테이블과 대응할 수 있는 필드 관련 기능만 존재.
데이터베이스 접속과 관련한 정보와 입력, 출력, 삭제와 같은 기능을 DAO 라는 별도 클래스에서 구현함.
데이터와 비즈니스 로직을 분리하므로 유지보수에 유리함.
-별도의 O-R 매핑 프레임워크를 사용하는 방법
DAO 대신 O-R 매핑 프레임워크를 사용하는 방식.  
O-R 매핑 : 빈즈(도메인) 객체와 데이터베이스 테이블의 칼럼을 자동으로 연결하고, 이들의 값을 동기화하며 상태를 유지하는 메커니즘을 제공함으로써 개발의 생산성과 안정성을 높일 수 있는 방법.
O-R 프레임워크에는 오라클 Top-Link,하이버네이트, 마이바티스 등이 존재.
오라클의 지원으로 Java EE에 JPA (Java Persistence API) 가 추가되어 O-R 매핑이 지원됨.

## 2.2 빈즈 클래스 구조
빈즈 클래스는 자바 클래스 구성을 따르지만 JSP 액션과 연동하기 위해 필요한 몇 가지 필수 구성에 차이가 있음.
문법적인 제약이 아니므로 규칙을 따르지 않아도 컴파일 오류는 발생하지 않음.
일반적인 빈즈는 매개변수가 없는 기본 생성자를 요구하므로 매개변수가 있는 생성자를 구현하는 경우에는 반드시 기본 생성자를 명시적으로 선언해 주어야 함.

-멤버 변수 : private로 데이터베이스의 테이블 칼럼명과 동일하게 선언되어 클래스 외부의 접근이 막히므로 getXXX, setXXX와 같은 이름의 빈즈 클래스 내부 메서드를 이용해야 함.
-getXxx 메서드 : JSP 액션에서 지정한 property 이름의 첫 글자를 대문자로 하는 setXxx 형식의 메서드를 정의해야 자동으로 호출됨.
-setXxx 메서드 : JSP 액션에서 지정한 property 이름의 첫 글자를 대문자로 하는 getXxx 형식의 메서드를 정의해야 자동으로 호출됨.

## 2.3 JSP에서 빈즈 선언
<jsp:useBean id ="빈즈 클래스의 인스턴스 이름", scope="빈즈 클래스의 생존 범위" class = "빈즈 클래스의 클래스 이름으로, 패키지 경로를 포함" />
    
    <jsp:useBean id = "mybean" scope = "request" class = "MyBean" />
    // 자바로 변환된 코드
    MyBean mybeann = (MyBean)request.getAttribute("myBean");
    if(mybean == null){
        mybean = new Mybean();
        request.setAttribute("mybean",mybean); 
    }
useBean 액션의 결과가 클래스의 인스턴스를 만드는 것이기는 하지만, id를 참조 변수로 연결하는 과정이 무조건 새로운 인스턴스를 생성하는 것이 아니라 내장객체의 속성 관리를 이용함.

## 2.4 JSP에서 빈즈 속성 설정
JSP에서 useBean 선언 후 setProperty와 getProperty 액션을 통해 빈즈 값을 설정하고 가져올 수 있음.
<jsp:setProperty name = "빈즈 클래스의 인스턴스 이름" property ="빈즈 클래스의 setXxx 메서드와 매칭될 속성 값 이름">
(<jsp:setProperty name = "빈즈 클래스의 인스턴스 이름" property ="*"/> 모든 setXxx 메서드에 매핑)
    <jsp:setProperty name = "mybean" property = "*" />
    // 동일한 코드
    <%
    mybean.setUserid(request.getParameter("username"));
    mybean.setPassword(request.getParameter("userpasswd));
    %>


## 2.5 빈즈에서 JSP로 속성 데이터 가져오기
<jsp:getProperty name = "빈즈 클래스의 인스턴스 이름" property ="빈즈 클래스의 getXxx 메서드와 매칭될 속성 값 이름"/>
    <jsp:getProperty name = "mybean" property = "username" />
    // 동일한 코드
    <%
    mybean.getUsername());
    %>
