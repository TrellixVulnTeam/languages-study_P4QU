#  JSP
--------------
## 1. JSP 개요
JSP : 자바로 구현된 기술로서, 특히 서블릿이라는 서버 프로그래밍 기술에 기반한 웹 프로그래밍 언어

### 1.1 서블릿과 JSP
서블릿 : 자바를 이용한 서버 프로그래밍 기술로서, 일반 애플리케이션을 개발하기 위해 만들어진 자바를 웹 환경에서 사용하려고 등장.  
초기의 웹 프로그래밍 기술인 CGI(Common Gateway Interface)를 대체하기 위해 개발되었으나, 느린 처리 속도, 많은 메모리 요구, 불편한 화면 제어 등의 한계로 인해 PHP, ASP 등에 주도권을 넘겨주게 됨. 그러다 SUN에서 서블릿을 기반으로 하면서 PHP와 유사한 JSP를 선보임.

JSP : 자바를 기반으로 만들어진 웹 프로그래밍 기술.
구조적으로는 서블릿에 기반하고 있으며 내부적으로 JSP가 서블릿 형태로 변환되는 구조
서블릿은 일반적인 자바 클래스의 형태를 취하고 있으며, JSP는 일반 텍스트를 비롯하여 HTML 코드와 몇몇 특수 태그, 자바 코드가 섞인 형태
(일반 텍스트 파일은 실행 가능한 프로그램이 아니므로 특정 동작 수행 불가능)  
JSP는 단순하고 직관적이라는 것 외에 서블릿을 기반으로 하기 때문에 자바가 지원하는 기능을 100% 사용할 수 있고 다양한 운영체제와 개발환경을 이용할 수 있다는 장점이 있음. 

JSP의 특징  
-자바의 모든 기능을 사용할 수 있어 발전 가능성이 무한함.  
-서블릿으로 컴파일된 후 메모리에서 처리되기 때문에 많은 사용자의 접속도 원활하게 처리 가능.  
-JSP 또는 다른 서블릿 간의 데이터를 쉽게 공유 가능.  
-빈즈라는 자바 컴포넌트 사용 가능.  
-커스텀 태그를 만들어 사용할 수 있으며, JSTL(JSP Standard Tag Library)과 같은 태그 라이브러리 이용 가능.  
-스트러츠, 스프링 @MVC 등 다양한 프레임워크와 결합하여 개발 가능.  

## 2. JSP 처리과정의 이해
JSP는 HTML과 달리 소스 자체로는 실행할 수 없으므로 여러 구성 요소 사이의 흐름을 이해해야 함

### 2.1 JSP 전체 동작 과정
1. 웹 브라우저에서 URL입력
2. DNS 서버로부터 입력한 URL을 변환한 IP주소를 받음
3. 받은 IP 주소의 웹 서버의 특정 포트에 JSP 페이지 요청
4. 웹 서버가 요청 내용을 분석하고 서블릿 컨테이너에 요청을 넘겨 처리
5. 화면에 보일 내용을 HTML 문서 형태로 웹 브라우저에 전송
   

### 2.2 서블릿 컨테이너 내부 과정
JSP가 HTML과 같은 일반적인 텍스트 파일 구조인데 비해, 서블릿은 자바 소스로 작성된 클래스 파일 구조로 되어있음.
서블릿 컨테이너는 JSP 파일을 서블릿 소스로 변환해서 컴파일하는데, 일단 컴파일 된 JSP는 단순한 파일이 아니라 컨테이너에서 서블릿 객체로 관리됨.
때문에 최초 JSP 파일에 접근할 때는 컴파일하는 시간이 많이 소요되지만 일단 컴파일되어실행된 다음부터는 서블릿 컨테이너가 처리하기 때문에 빠르게 실행됨.

1. 웹 서버로부터 JSP에 대한 사용자 요청이 컨테이너(톰캣)로 전달됨
2. 요청 JSP에 대한 서블릿 클래스가 존재하면 다음 단계로 진행하고, 존재하지 않을 경우 JSP를 .java 파일로 변환(개발자가 작성한 JSP소스는 _jspService() 메서드에 들어감.)
3. 메모리에 존재 여부를 확인하여 .java 파일을 클래스로 컴파일(컴퓨터에서 실행 가능한 형태인 클래스 파일은 소스가 변경되기 전까지는 메모리에 상주하면서 다시 컴파일되지 않고 서비스됨. JSP 파일이 수정되기 전까지는 과정이 진행되지 않음).
4. 컴파일된 JSP의 서블릿 클래스는 jspInit() 메서드를 통해 Ready 상태가 되고 컨테이너의 메모리에 적재되어 실행됨
5. 이후 모든 클라이언트 접속에 따라 _jspService() 메서드만 반복해서 호출됨
6. 데이터 베이스 처리 혹은 별도의 기능을 위한 클래스 호출 등이 있다면 실행하고 결과를 취합해 HTML 형태로 구성
7. HTML 형태의 결과를 웹 서버를 경유해 사용자 브라우저에 전달함.
8. 컨테이너가 종료될 때 jspDestroy() 메서드를 통해 메모리에서 언로드되고, 다시 컨테이너가 시작될 경우 최초 클라이언트 요청에 대한 클래스가 있으므로 재컴파일 과정은 거치지 않고, jspInit() 메서드 호출을 통해 메모리에 로드함.

## 3. 프로그램 기술 변천
현재 유행하는 JSP 웹 프로그래밍 모델은 MVC 패턴이라 불리는 JSP 모델-2.

### 3.1 서블릿과 JSP 기술 변천
1. 초기 자바 기반 웹 프로그램은 서블릿 중심이었으나, 웹이 화면의 중심이라는 특성으로 인해 프로그램 내에서 화면을 처리하는 데 여러 문제를 야기함
2. 화면을 중심으로 자바 프로그램을 연동할 수 있는 JSP가 등장하였으나 JSP 내에서의 과도한 스크립트릿을 사용하는 문제로 프로그램 개발 구조의 변화가 요구됨. (초기의 JSP 개발 모델인 JSP 모델-1)
3. JSP 모델이 코드와 프로그램이 뒤섞인 구조였기 때문에 신속한 유지보수와 서비스 확장이 이려웠음. 
이를 해결하기 위해 MVC(Model-view-Controller)) 패턴이라 불리는 JSP 모델-2 사용.  
MVC 패턴의 기본 개념은 사용자에게 보일 페이지와(View) 데이터 처리(Model), 그리고 이들 상호 간의 흐름을 제어하는 모듈을(Controller) 분리하는 것으로 더욱 쉽게 웹 애플리케이션을 확장하고 유지보수 가능.   MVC 패턴 구현은 패턴에서 요구하는 규칙에 따라 개발자가 직접 구조를 설계하거나 스프링3 @MVC, 스트러츠 같은 오픈소스 프레임워크 사용 가능.  
-Model :  자바 클래스로 구현되며 보통 DO, DAO와 같은 데이터 처리 클래스로 구성.  
-View : 화면 처리와 관련된 것으로 기본적으로 JSP 영역이며 HTML, CSS 외의 표현 언어, 커스텀 태그 등이 사용됨.  
-Controller : 모델과 뷰를 연결하는 역할을 수행. 사용자 요청을 받아들이고 데이터를 처리한 후 결과를 뷰에 전달함.


### 3.2 JSP 프로그램 모델 유형 비교
유형-1 : 빈즈 클래스를 사용하지 않고 스크립트릿만을 사용하는 방법
외부 클래스를 사용하는 부분도 스크립트릿에서 사용하므로 개발 과정에서 JSP 파일에만 집중할 수 있고, 비교적 배우기 쉽지만 소스코드가 복잡해짐.  
스크립트릿 : JSP 파일에 자바 프로그램 문법을 사용할 수있는 JSP 구문.  

유형-2 : 빈즈 클래스와 <jsp:useBean> 액션을 적극적으로 사용하는 방법
간단한 소스코드  
프로그램으로 구현되는 기능들을 캡슐화하여 재활용하기 쉽고, JSP 파일 간의 공유도 쉬움.  
-빈즈를 이용한 JSP 처리 과정
1. 웹 브라우저 요청에 대해서 웹 서버가 http 프로토콜에 따라 사용자 요청을 처리함.
2. 웹 서버는 HTML과 JSP인 경우를 구분해서 처리함.
3. JSP의 경우 useBean 액션을 이용해서 빈즈 클래스와 연동함.
4. 필요한 경우 데이터베이스 관련 작업 등을 처리함.
5. 처리한 결과를 보여주는 JSP를 호출함.
6. 필요한 경우 결과를 보여주는 JSP에서도 빈즈 사용 가능.

