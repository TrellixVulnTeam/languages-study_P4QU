8.포인터와 함수
==============
## 1. 함수의 의미
특정 기능을 수행하는 논리적 연산의 흐름을 묶은 단위로 함수 이름을 식별자라 함.  
기능을 수행하는데 필요한 정보를 매개 변수의 형식으로 전달받아 그 결과를 각종 자료형으로 반환함.

cf> C언어의 문법 중 함수만큼 경험을 요구하는 것도 없을 것 같다. 다른 문법들은 보통 이해하고 외우면 사용할 수 있지만, 함수는 기본 개념을 이해해야 하는 것은 물론이고, 여기에 직접 만들고 많이 사용해야만 비로소 좋은 함수를 만들 수 있다. - <열혈강의 다양한 예제로 완성하는 C포인터> 중

C언어 프로그램은 main() 함수에서 시작하여 함수 안에서 여러 함수를 호출한 후 main() 함수에서 종료됨. main() 함수보다 후에 선언 및 정의된 함수를 호출할 경우 컴파일러가 함수의 형태를 알 수 없어 컴파일 에러가 발생. 따라서 main() 함수 전에 함수를 선언 및 정의하거나 main()함수 전에 함수의 원형을 선언한 후 main()함수 후에 함수를 정의해야 함.

### 1.1. 인자(argument)와 매개 변수(parameter)


## 2. 주소를 인자 값으로 전달받는 함수
포인터 변수(n중 포인터, n차원 배열 포인터, 구조체 포인터, 공용체 포인터)를 매개 변수로 선언하여 주소를 인자 값으로 전달받을 수 있음.

## 2.1. 값에 의한 호출(Call by Value)과 참조에 의한 호출(Call by Reference)
값에 의한 호출은 변수의 값을 함수에 전달하는 방식이고 참조에 의한 호출은 주소를 함수에 전달하는 방식.  
값에 의한 호출은 호출된 함수에서 복사된 메모리를 이용하지만 참조에 의한 호출은 호출된 함수에서 주소를 이용하여 원본 메모리에 접근 가능. 

## 3. 주소를 반환 값으로 전달하는 함수
포인터 변수(n중 포인터, n차원 배열 포인터, 구조체 포인터, 공용체 포인터)를 반환형으로 선언하여 주소를 반환 값으로 반환할 수 있음. 

함수가 종료하면 자동 변수는 소멸하기 때문에 함수의 반환값으로 어떤 자료형의 주소든 반환할 수 있지만 함수의 반환 값으로 자동 변수의 주소를 사용하면 안 됨. 

## 4. 함수 호출 규약(Calling Convention)
함수 호출 규약은 함수를 호출하는 방식에 대한 일종의 약속.
함수를 호출할 때 인자를 스택에 어떻게 쌓을 것인가와 함수 스택 프레임을 반환할 때 함수 호출자(Caller)와 함수 피호출자(Callee) 중 어디에서 반환할 것인지에 대해 명시.
함수 호출 규약에 따라 프로그램 수행 성능이 달라짐.
* __cdecl 방식은 함수에 인자를 전달할 때 오른쪽에서 왼쪽으로 전달하며 스택에 쌓아 올림. 함수 스택 프레임은 호출자에서 반환. C언어에서 함수에 어떤 호출 규약도 명시하지 않으면 --cdecl이 생략된 것.
* __stdcall 방식은 함수에 인자를 전달할 때 오른쪽에서 왼쪽으로 전달하며 스택에 쌓아 올림. 함수 스택 프레임은 피호출자에서 반환함.

> 함수 스택 프레임 반환은 무엇을 반환? __cdecl 규약의 함수에서 자동 변수의 주소 반환 불가?

## 5. 함수 포인터
함수 포인터란 함수의 시작 주소를 저장할 수 있는 포인터 변수
모든 함수의 이름은 함수가 시작하는 주소를 나타냄.

함수 포인터를 이용해 저장된 주소로 함수 호출 가능.
서로 다른 함수들을 같은 이름으로 호출하여 호출할 때마다 서로 다른 기능을 수행할 수 있도록 하며,
함수의 크기에 상관없이 함수의 주소 4바이트만을 저장함으로써 배열의 시작 주소를 저장하여 배열 요소에 접근하듯 함수의 기능을 사용할 수 있도록 함.

함수 포인터 사용 시 호출 규약을 정확하게 명시해야 함. 
> 호출 규약이 다르면 컴파일 에러?
> 함수 포인터로 함수 메모리에 접근해도 메모리는 상수로 변경 불가? 접근하면 실체는?
    void main(void);
    void (*p) (void);

> int (*func[2])() 함수 포인터 배열
> 매개 변수에서 int *ap와 int ap[]의 차이?
> 매개 변수에서 int(*ap)[3]과 int ap[][3]의 차이?

## 6. 다양한 함수
### 6.1. 가변 인자 사용 함수
가변 인자란 함수의 인자를 고정하지 않고 개수와 형태를 다르게 호출하는 방법.  
첫 번째 인자는 매개변수의 이름은 필수, 나머지 인자들의 개수와 자료형의 정보를 전달받음.
    void func(...)
    {
    }

C언어에서 printf() 함수가 대표적인 가변 인자 사용 함수.

전달한 인자들의 수와 메모리 주소를 알 수없으므로 전달된 인자들이 메모리에 연속적으로 생성된다는 것을 이용하여 인자를 사용.  
첫 번째 매개변수의 주소와 크기를 통해 모든 인자의 주소를 알아내어 메모리 자체(값)에 접근.

인자의 크기를 확인하고 인자의 주소를 계산하려면 복잡하므로 가변 인자를 쉽게 사용할 수 있도록 <stdarg.h>에 매크로 함수가 제공됨. va_start(), va_arg(), va_end()등

### 6.2. 콜백 함수
서버와 클라이언트  
서버는 이미 존재하는 라이브러리 상에 존재할 수 있으며 시스템이 제공하는 API나 SDK 등일 수 있음.  
서버는 이미 만들어져 제공되므로 수정이나 확장 불가.
때때로 서버가 클라이언트를 호출해야 하는 경우 서버가 클라이언트를 호출하는 것을 콜백이라 함.
콜백을 사용하면 서버에서 수행되는 서비스의 정책을 클라이언트에서 유연하게 바꿀 수 있고, 서버는 클라이언트의 정보가 필요하지 않으므로 라이브러리나 파일 등으로 미리 만들어져 제공될 수 있음.
eg> 내림차순이나 오름차순 정렬

### 6.2. 재귀 함수
재귀함수는 자신의 함수를 직접 또는 간접적으로 다시 호출하는 함수. 
자신의 함수를 호출해도 다른 호출 스택 프레임(함수를 호출할 때마다 유지되는 함수의 상태 집합)을 가짐.

직접 호출

    void a()
    {
        a();
    }

간접 호출

    void b()
    {
        a();
    }    
    void a()
    {
        b();
    }

비선형적(재귀)인 명령어의 반복을 처리할 때는 반복문보다 재귀 함수를 사용하는 것이 문제와 코드를 단순화.